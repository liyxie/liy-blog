{"remainingRequest":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\node_modules\\.store\\babel-loader@8.3.0\\node_modules\\babel-loader\\lib\\index.js!E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\src\\components\\Comment.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\src\\components\\Comment.vue","mtime":1721286706039},{"path":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\babel.config.js","mtime":1721286706021},{"path":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\node_modules\\.store\\babel-loader@8.3.0\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBSZXBseSBmcm9tICIuL1JlcGx5IjsKaW1wb3J0IFBhZ2luZyBmcm9tICIuL1BhZ2luZyI7CmltcG9ydCBFbW9qaSBmcm9tICIuL0Vtb2ppIjsKaW1wb3J0IEVtb2ppTGlzdCBmcm9tICIuLi9hc3NldHMvanMvZW1vamkiOwppbXBvcnQgeyBhZGRDb21tZW50LCBmZXRjaENvbW1lbnRzLCByZXBsaWVzQnlDb21JZCB9IGZyb20gJy4uL2FwaSc7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBSZXBseSwKICAgIEVtb2ppLAogICAgUGFnaW5nCiAgfSwKICBwcm9wczogewogICAgY29tbWVudExpc3Q6IHsKICAgICAgdHlwZTogQXJyYXkKICAgIH0sCiAgICBjb3VudDogewogICAgICB0eXBlOiBOdW1iZXIKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB7CiAgICAgIHJlRnJlc2g6IHRydWUsCiAgICAgIGltZzogcHJvY2Vzcy5lbnYuVlVFX0FQUF9JTUdfQVBJLAogICAgICBjb21tZW50Q29udGVudDogIiIsCiAgICAgIGNob29zZUVtb2ppOiBmYWxzZSwKICAgICAgY3VycmVudDogMQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHJlcGx5Q29tbWVudChpbmRleCwgaXRlbSkgewogICAgICB0aGlzLiRyZWZzLnJlcGx5LmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgaXRlbS4kZWwuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgfSk7CiAgICAgIC8v5Lyg5YC857uZ5Zue5aSN5qGGCiAgICAgIHRoaXMuJHJlZnMucmVwbHlbaW5kZXhdLmNvbW1lbnRDb250ZW50ID0gIiI7CiAgICAgIHRoaXMuJHJlZnMucmVwbHlbaW5kZXhdLm5pY2tuYW1lID0gaXRlbS5uaWNrbmFtZTsKICAgICAgdGhpcy4kcmVmcy5yZXBseVtpbmRleF0ucmVwbHlVc2VySWQgPSBpdGVtLnVzZXJJZDsKICAgICAgdGhpcy4kcmVmcy5yZXBseVtpbmRleF0ucGFyZW50SWQgPSB0aGlzLmNvbW1lbnRMaXN0W2luZGV4XS5pZDsKICAgICAgdGhpcy4kcmVmcy5yZXBseVtpbmRleF0uY2hvb3NlRW1vamkgPSBmYWxzZTsKICAgICAgdGhpcy4kcmVmcy5yZXBseVtpbmRleF0uaW5kZXggPSBpbmRleDsKICAgICAgdGhpcy4kcmVmcy5yZXBseVtpbmRleF0uJGVsLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgfSwKICAgIGFkZEVtb2ppKGtleSkgewogICAgICB0aGlzLmNvbW1lbnRDb250ZW50ICs9IGtleTsKICAgIH0sCiAgICBjaGVja1JlcGxpZXMoaW5kZXgsIGl0ZW0pIHsKICAgICAgcmVwbGllc0J5Q29tSWQoewogICAgICAgIGNvbW1lbnRJZDogaXRlbS5pZCwKICAgICAgICBwYWdlTm86IDEsCiAgICAgICAgcGFnZVNpemU6IDUKICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMuJHJlZnMuY2hlY2tbaW5kZXhdLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgaXRlbS5yZXBseURUT0xpc3QgPSByZXMuZGF0YTsKICAgICAgICAvL+i2hei/hzHpobXmiY3mmL7npLrliIbpobUKICAgICAgICBpZiAoTWF0aC5jZWlsKGl0ZW0ucmVwbHlDb3VudCAvIDUpID4gMSkgewogICAgICAgICAgdGhpcy4kcmVmcy5wYWdpbmdbaW5kZXhdLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjaGFuZ2VSZXBseUN1cnJlbnQoY3VycmVudCwgaW5kZXgsIGNvbW1lbnRJZCkgewogICAgICAvL+afpeeci+S4i+S4gOmhteWbnuWkjQogICAgICByZXBsaWVzQnlDb21JZCh7CiAgICAgICAgY29tbWVudElkOiBjb21tZW50SWQsCiAgICAgICAgcGFnZU5vOiBjdXJyZW50LAogICAgICAgIHBhZ2VTaXplOiA1CiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLmNvbW1lbnRMaXN0W2luZGV4XS5yZXBseURUT0xpc3QgPSByZXMuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgbGlzdENvbW1lbnRzKCkgewogICAgICAvL+afpeeci+S4i+S4gOmhteivhOiuugogICAgICB0aGlzLmN1cnJlbnQrKzsKICAgICAgY29uc3QgcGF0aCA9IHRoaXMuJHJvdXRlLnBhdGg7CiAgICAgIGNvbnN0IGFyciA9IHBhdGguc3BsaXQoIi8iKTsKICAgICAgZmV0Y2hDb21tZW50cyh7CiAgICAgICAgcGFnZU5vOiB0aGlzLmN1cnJlbnQsCiAgICAgICAgcGFnZVNpemU6IDEwLAogICAgICAgIGFydGljbGVJZDogYXJyWzJdCiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICByZXMuZGF0YS5jb21tZW50RFRPTGlzdC5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgICAgdGhpcy5jb21tZW50TGlzdC5wdXNoKGl0ZW0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBpbnNlcnRDb21tZW50KCkgewogICAgICAvL+WIpOaWreeZu+W9lQogICAgICBsZXQgdXNlcklkID0gdGhpcy4kc3RvcmUuc3RhdGUudXNlcklkOwogICAgICBpZiAoIXVzZXJJZCkgewogICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLmxvZ2luRmxhZyA9IHRydWU7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIC8v5Yik56m6CiAgICAgIGlmICh0aGlzLmNvbW1lbnRDb250ZW50LnRyaW0oKSA9PT0gIiIpIHsKICAgICAgICB0aGlzLiR0b2FzdCh7CiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgbWVzc2FnZTogIuivhOiuuuS4jeiDveS4uuepuiIKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgLy/op6PmnpDooajmg4UKICAgICAgdmFyIHJlZyA9IC9cWy4rP1xdL2c7CiAgICAgIHRoaXMuY29tbWVudENvbnRlbnQgPSB0aGlzLmNvbW1lbnRDb250ZW50LnJlcGxhY2UocmVnLCBmdW5jdGlvbiAoc3RyKSB7CiAgICAgICAgcmV0dXJuICI8aW1nIHNyYz0gJyIgKyBFbW9qaUxpc3Rbc3RyXSArICInIHdpZHRoPScyMidoZWlnaHQ9JzIwJyBzdHlsZT0ncGFkZGluZzogMCAxcHgnLz4iOwogICAgICB9KTsKICAgICAgLy/lj5HpgIHor7fmsYIKICAgICAgY29uc3QgcGF0aCA9IHRoaXMuJHJvdXRlLnBhdGg7CiAgICAgIGNvbnN0IGFyciA9IHBhdGguc3BsaXQoIi8iKTsKICAgICAgdmFyIGNvbW1lbnQgPSB7CiAgICAgICAgYXJ0aWNsZUlkOiBhcnJbMl0sCiAgICAgICAgY29tbWVudENvbnRlbnQ6IHRoaXMuY29tbWVudENvbnRlbnQKICAgICAgfTsKICAgICAgdGhpcy5jb21tZW50Q29udGVudCA9ICIiOwogICAgICBhZGRDb21tZW50KGNvbW1lbnQpLnRoZW4ocmVzID0+IHsKICAgICAgICAvL+afpeivouacgOaWsOivhOiuugogICAgICAgIHRoaXMuJGVtaXQoInJlbG9hZENvbW1lbnQiKTsKICAgICAgICB0aGlzLiR0b2FzdCh7CiAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICBtZXNzYWdlOiAi6K+E6K665oiQ5YqfIgogICAgICAgIH0pOwogICAgICAgIC8qIGNvbnN0IGlzUmV2aWV3ID0gdGhpcy4kc3RvcmUuc3RhdGUuYmxvZ0luZm8ud2Vic2l0ZUNvbmZpZw0KICAgICAgICAgICAuaXNDb21tZW50UmV2aWV3Ow0KICAgICAgICAgaWYgKGlzUmV2aWV3KSB7DQogICAgICAgICAgIHRoaXMuJHRvYXN0KHsgdHlwZTogIndhcm5uaW5nIiwgbWVzc2FnZTogIuivhOiuuuaIkOWKn++8jOato+WcqOWuoeaguOS4rSIgfSk7DQogICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICB0aGlzLiR0b2FzdCh7IHR5cGU6ICJzdWNjZXNzIiwgbWVzc2FnZTogIuivhOiuuuaIkOWKnyIgfSk7DQogICAgICAgICB9Ki8KICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICBjb25zb2xlLmVycm9yKGVycik7CiAgICAgIH0pOwogICAgfSwKICAgIHJlbG9hZFJlcGx5KGluZGV4KSB7CiAgICAgIHJlcGxpZXNCeUNvbUlkKHsKICAgICAgICBjb21tZW50SWQ6IHRoaXMuY29tbWVudExpc3RbaW5kZXhdLmlkLAogICAgICAgIHBhZ2VTaXplOiA1LAogICAgICAgIHBhZ2VObzogdGhpcy4kcmVmcy5wYWdlW2luZGV4XS5jdXJyZW50CiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLmNvbW1lbnRMaXN0W2luZGV4XS5yZXBseUNvdW50Kys7CiAgICAgICAgLy/lm57lpI3lpKfkuo415p2h5bGV56S65YiG6aG1CiAgICAgICAgaWYgKHRoaXMuY29tbWVudExpc3RbaW5kZXhdLnJlcGx5Q291bnQgPiA1KSB7CiAgICAgICAgICB0aGlzLiRyZWZzLnBhZ2luZ1tpbmRleF0uc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgICAgICB9CiAgICAgICAgdGhpcy4kcmVmcy5jaGVja1tpbmRleF0uc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICB0aGlzLiRyZWZzLnJlcGx5W2luZGV4XS4kZWwuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICB0aGlzLmNvbW1lbnRMaXN0W2luZGV4XS5yZXBseURUT0xpc3QgPSByZXMuZGF0YTsKICAgICAgfSk7CiAgICB9CiAgfSwKICAvKiBjb21wdXRlZDogew0KICAgICBpc0xpa2UoKSB7DQogICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNvbW1lbnRJZCkgew0KICAgICAgICAgdmFyIGNvbW1lbnRMaWtlU2V0ID0gdGhpcy4kc3RvcmUuc3RhdGUuY29tbWVudExpa2VTZXQ7DQogICAgICAgICByZXR1cm4gY29tbWVudExpa2VTZXQuaW5kZXhPZihjb21tZW50SWQpICE9IC0xID8gImxpa2UtYWN0aXZlIiA6ICJsaWtlIjsNCiAgICAgICB9Ow0KICAgICB9DQogICB9LCovCiAgd2F0Y2g6IHsKICAgIGNvbW1lbnRMaXN0KCkgewogICAgICB0aGlzLnJlRnJlc2ggPSBmYWxzZTsKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMucmVGcmVzaCA9IHRydWU7CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"names":["Reply","Paging","Emoji","EmojiList","addComment","fetchComments","repliesByComId","components","props","commentList","type","Array","count","Number","data","reFresh","img","process","env","VUE_APP_IMG_API","commentContent","chooseEmoji","current","methods","replyComment","index","item","$refs","reply","forEach","$el","style","display","nickname","replyUserId","userId","parentId","id","addEmoji","key","checkReplies","commentId","pageNo","pageSize","then","res","check","replyDTOList","Math","ceil","replyCount","paging","changeReplyCurrent","listComments","path","$route","arr","split","articleId","commentDTOList","push","insertComment","$store","state","loginFlag","trim","$toast","message","reg","replace","str","comment","$emit","catch","err","console","error","reloadReply","page","watch","$nextTick"],"sources":["src/components/Comment.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"comment-title\"><i class=\"iconfont iconpinglunzu\" />评论</div>\r\n    <!-- 评论框 -->\r\n    <div class=\"comment-input-wrapper\">\r\n      <div style=\"display:flex\">\r\n        <v-avatar size=\"40\">\r\n          <img\r\n            v-if=\"this.$store.state.avatar\"\r\n            :src=\"this.$store.state.avatar\"\r\n          />\r\n          <img\r\n            v-else\r\n            :src=\"this.$store.state.blogInfo.webSite.touristAvatar\"\r\n          />\r\n        </v-avatar>\r\n        <div style=\"width:100%\" class=\"ml-3\">\r\n          <div class=\"comment-input\">\r\n            <textarea\r\n              class=\"comment-textarea\"\r\n              v-model=\"commentContent\"\r\n              placeholder=\"留下点什么吧...\"\r\n              auto-grow\r\n              dense\r\n            />\r\n          </div>\r\n          <!-- 操作按钮 -->\r\n          <div class=\"emoji-container\">\r\n            <span\r\n              :class=\"chooseEmoji ? 'emoji-btn-active' : 'emoji-btn'\"\r\n              @click=\"chooseEmoji = !chooseEmoji\"\r\n            >\r\n              <i class=\"iconfont iconbiaoqing\" />\r\n            </span>\r\n            <button\r\n              @click=\"insertComment\"\r\n              class=\"upload-btn v-comment-btn\"\r\n              style=\"margin-left:auto\"\r\n            >\r\n              提交\r\n            </button>\r\n          </div>\r\n          <!-- 表情框 -->\r\n          <emoji @addEmoji=\"addEmoji\" :chooseEmoji=\"chooseEmoji\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- 评论详情 -->\r\n    <div v-if=\"count > 0 && reFresh\">\r\n      <!-- 评论数量 -->\r\n      <div class=\"count\">{{ count }} 评论</div>\r\n      <!-- 评论列表 -->\r\n      <div\r\n        style=\"display:flex\"\r\n        class=\"pt-5\"\r\n        v-for=\"(item, index) of commentList\"\r\n        :key=\"item.id\"\r\n      >\r\n        <!-- 头像 -->\r\n        <v-avatar size=\"40\" class=\"comment-avatar\">\r\n          <img :src=\"item.avatar\" />\r\n        </v-avatar>\r\n        <div class=\"comment-meta\">\r\n          <!-- 用户名 -->\r\n          <div class=\"comment-user\">\r\n            <span v-if=\"!item.webSite\">{{ item.nickname }}</span>\r\n            <a v-else :href=\"item.webSite\" target=\"_blank\">\r\n              {{ item.nickname }}\r\n            </a>\r\n            <span class=\"blogger-tag\" v-if=\"item.userId == 1\">博主</span>\r\n          </div>\r\n          <!-- 信息 -->\r\n          <div class=\"comment-info\">\r\n            <!-- 楼层 -->\r\n            <span style=\"margin-right:10px\">{{ count - index }}楼</span>\r\n            <!-- 发表时间 -->\r\n            <span style=\"margin-right:10px\">{{ item.createTime | date }}</span>\r\n            <!-- 点赞 -->\r\n<!--            <span\r\n              :class=\"isLike(item.id) + ' iconfont icondianzan'\"\r\n              @click=\"like(item)\"\r\n            />-->\r\n            <span v-show=\"item.likeCount > 0\"> {{ item.likeCount }}</span>\r\n            <!-- 回复 -->\r\n            <span class=\"reply-btn\" @click=\"replyComment(index, item)\">\r\n              回复\r\n            </span>\r\n          </div>\r\n          <!-- 评论内容 -->\r\n          <p v-html=\"item.commentContent\" class=\"comment-content\"></p>\r\n          <!-- 回复人 -->\r\n          <div\r\n            style=\"display:flex\"\r\n            v-for=\"reply of item.replyDTOList\"\r\n            :key=\"reply.id\"\r\n          >\r\n            <!-- 头像 -->\r\n            <v-avatar size=\"36\" class=\"comment-avatar\">\r\n              <img :src=\"reply.avatar\" />\r\n            </v-avatar>\r\n            <div class=\"reply-meta\">\r\n              <!-- 用户名 -->\r\n              <div class=\"comment-user\">\r\n                <span v-if=\"!reply.webSite\">{{ reply.nickname }}</span>\r\n                <a v-else :href=\"reply.webSite\" target=\"_blank\">\r\n                  {{ reply.nickname }}\r\n                </a>\r\n                <span class=\"blogger-tag\" v-if=\"reply.userId === 1\">博主</span>\r\n              </div>\r\n              <!-- 信息 -->\r\n              <div class=\"comment-info\">\r\n\r\n                <!-- 发表时间 -->\r\n                <span style=\"margin-right:10px\">\r\n                  {{ reply.createTime | date }}\r\n                </span>\r\n                <!-- 点赞 -->\r\n<!--                <span\r\n                  :class=\"isLike(reply.id) + ' iconfont icondianzan'\"\r\n                  @click=\"like(reply)\"\r\n                />-->\r\n                <span v-show=\"reply.likeCount > 0\"> {{ reply.likeCount }}</span>\r\n                <!-- 回复 -->\r\n                <span class=\"reply-btn\" @click=\"replyComment(index, reply)\">\r\n                  回复\r\n                </span>\r\n              </div>\r\n              <!-- 回复内容 -->\r\n              <p class=\"comment-content\">\r\n                <!-- 回复用户名 -->\r\n                <template v-if=\"reply.replyUserId !== item.userId\">\r\n                  <span v-if=\"!reply.replyWebSite\" class=\"comment-nickname ml-1\">\r\n                    @{{ reply.replyNickname }}\r\n                  </span>\r\n                  <a\r\n                    v-else\r\n                    :href=\"reply.replyWebSite\"\r\n                    target=\"_blank\"\r\n                    class=\"comment-nickname ml-1\"\r\n                  >\r\n                    @{{ reply.replyNickname }}\r\n                  </a>\r\n                </template>\r\n                <span v-html=\"reply.content\" />\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <!-- 回复数量 -->\r\n          <div\r\n            class=\"mb-3\"\r\n            style=\"font-size:0.75rem;color:#6d757a\"\r\n            v-show=\"item.replyCount > 3\"\r\n            ref=\"check\"\r\n          >\r\n            共\r\n            <b>{{ item.replyCount }}</b>\r\n            条回复，\r\n            <span\r\n              style=\"color:#00a1d6;cursor:pointer\"\r\n              @click=\"checkReplies(index, item)\"\r\n            >\r\n              点击查看\r\n            </span>\r\n          </div>\r\n          <!-- 回复分页 -->\r\n          <div\r\n            class=\"mb-3\"\r\n            style=\"font-size:0.75rem;color:#222;display:none\"\r\n            ref=\"paging\"\r\n          >\r\n            <span style=\"padding-right:10px\">\r\n              共{{ Math.ceil(item.replyCount / 5) }}页\r\n            </span>\r\n            <paging\r\n              ref=\"page\"\r\n              :totalPage=\"Math.ceil(item.replyCount / 5)\"\r\n              :index=\"index\"\r\n              :commentId=\"item.id\"\r\n              @changeReplyCurrent=\"changeReplyCurrent\"\r\n            />\r\n          </div>\r\n          <!-- 回复框 -->\r\n          <Reply ref=\"reply\" @reloadReply=\"reloadReply\" />\r\n        </div>\r\n      </div>\r\n      <!-- 加载按钮 -->\r\n      <div class=\"load-wrapper\">\r\n        <v-btn outlined v-if=\"count > commentList.length\" @click=\"listComments\">\r\n          加载更多...\r\n        </v-btn>\r\n      </div>\r\n    </div>\r\n    <!-- 没有评论提示 -->\r\n    <div v-else style=\"padding:1.25rem;text-align:center\">\r\n      来发评论吧~\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Reply from \"./Reply\";\r\nimport Paging from \"./Paging\";\r\nimport Emoji from \"./Emoji\";\r\nimport EmojiList from \"../assets/js/emoji\";\r\nimport {addComment,fetchComments,repliesByComId} from '../api'\r\nexport default {\r\n  components: {\r\n    Reply,\r\n    Emoji,\r\n    Paging\r\n  },\r\n  props: {\r\n    commentList: {\r\n      type: Array\r\n    },\r\n    count: {\r\n      type: Number\r\n    }\r\n  },\r\n  data: function() {\r\n    return {\r\n      reFresh: true,\r\n      img: process.env.VUE_APP_IMG_API,\r\n      commentContent: \"\",\r\n      chooseEmoji: false,\r\n      current: 1\r\n    };\r\n  },\r\n  methods: {\r\n    replyComment(index, item) {\r\n      this.$refs.reply.forEach(item => {\r\n        item.$el.style.display = \"none\";\r\n      });\r\n      //传值给回复框\r\n      this.$refs.reply[index].commentContent = \"\";\r\n      this.$refs.reply[index].nickname = item.nickname;\r\n      this.$refs.reply[index].replyUserId = item.userId;\r\n      this.$refs.reply[index].parentId = this.commentList[index].id;\r\n      this.$refs.reply[index].chooseEmoji = false;\r\n      this.$refs.reply[index].index = index;\r\n      this.$refs.reply[index].$el.style.display = \"block\";\r\n    },\r\n    addEmoji(key) {\r\n      this.commentContent += key;\r\n    },\r\n    checkReplies(index, item) {\r\n      repliesByComId( {commentId:item.id, pageNo: 1, pageSize: 5 }).then(res => {\r\n          this.$refs.check[index].style.display = \"none\";\r\n          item.replyDTOList = res.data;\r\n          //超过1页才显示分页\r\n          if (Math.ceil(item.replyCount / 5) > 1) {\r\n            this.$refs.paging[index].style.display = \"flex\";\r\n          }\r\n        });\r\n    },\r\n    changeReplyCurrent(current, index, commentId) {\r\n      //查看下一页回复\r\n      repliesByComId( {commentId:commentId, pageNo: current, pageSize: 5 }).then(res => {\r\n          this.commentList[index].replyDTOList = res.data;\r\n        });\r\n    },\r\n    listComments() {\r\n      //查看下一页评论\r\n      this.current++;\r\n      const path = this.$route.path;\r\n      const arr = path.split(\"/\");\r\n      fetchComments( { pageNo: this.current,pageSize:10, articleId: arr[2] }).then(res => {\r\n        res.data.commentDTOList.forEach(item =>{\r\n          this.commentList.push(item);\r\n        })\r\n      });\r\n    },\r\n    insertComment() {\r\n      //判断登录\r\n      let userId = this.$store.state.userId;\r\n      if (!userId) {\r\n        this.$store.state.loginFlag = true;\r\n        return false;\r\n      }\r\n      //判空\r\n      if (this.commentContent.trim() === \"\") {\r\n        this.$toast({ type: \"error\", message: \"评论不能为空\" });\r\n        return false;\r\n      }\r\n      //解析表情\r\n      var reg = /\\[.+?\\]/g;\r\n      this.commentContent = this.commentContent.replace(reg, function(str) {\r\n        return (\r\n          \"<img src= '\" +\r\n          EmojiList[str] +\r\n          \"' width='22'height='20' style='padding: 0 1px'/>\"\r\n        );\r\n      });\r\n      //发送请求\r\n      const path = this.$route.path;\r\n      const arr = path.split(\"/\");\r\n      var comment = {\r\n        articleId: arr[2],\r\n        commentContent: this.commentContent\r\n      };\r\n      this.commentContent = \"\";\r\n      addComment(comment).then(res => {\r\n          //查询最新评论\r\n          this.$emit(\"reloadComment\");\r\n          this.$toast({ type: \"success\", message: \"评论成功\" });\r\n         /* const isReview = this.$store.state.blogInfo.websiteConfig\r\n            .isCommentReview;\r\n          if (isReview) {\r\n            this.$toast({ type: \"warnning\", message: \"评论成功，正在审核中\" });\r\n          } else {\r\n            this.$toast({ type: \"success\", message: \"评论成功\" });\r\n          }*/\r\n      }).catch(err =>{\r\n        console.error(err)\r\n      });\r\n    },\r\n    reloadReply(index) {\r\n      repliesByComId( {\r\n            commentId:this.commentList[index].id,\r\n            pageSize:5,\r\n            pageNo: this.$refs.page[index].current\r\n          }).then(res => {\r\n          this.commentList[index].replyCount++;\r\n          //回复大于5条展示分页\r\n          if (this.commentList[index].replyCount > 5) {\r\n            this.$refs.paging[index].style.display = \"flex\";\r\n          }\r\n          this.$refs.check[index].style.display = \"none\";\r\n          this.$refs.reply[index].$el.style.display = \"none\";\r\n          this.commentList[index].replyDTOList = res.data;\r\n        });\r\n    }\r\n  },\r\n /* computed: {\r\n    isLike() {\r\n      return function(commentId) {\r\n        var commentLikeSet = this.$store.state.commentLikeSet;\r\n        return commentLikeSet.indexOf(commentId) != -1 ? \"like-active\" : \"like\";\r\n      };\r\n    }\r\n  },*/\r\n  watch: {\r\n    commentList() {\r\n      this.reFresh = false;\r\n      this.$nextTick(() => {\r\n        this.reFresh = true;\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\np {\r\n  margin-bottom: 1.25rem !important;\r\n}\r\n.blogger-tag {\r\n  background: #ffa51e;\r\n  font-size: 12px;\r\n  display: inline-block;\r\n  border-radius: 2px;\r\n  color: #fff;\r\n  padding: 0 5px;\r\n  margin-left: 6px;\r\n}\r\n.comment-title {\r\n  display: flex;\r\n  align-items: center;\r\n  font-size: 1.25rem;\r\n  font-weight: bold;\r\n  line-height: 40px;\r\n  margin-bottom: 10px;\r\n}\r\n.comment-title i {\r\n  font-size: 1.5rem;\r\n  margin-right: 5px;\r\n}\r\n.comment-input-wrapper {\r\n  border: 1px solid #90939950;\r\n  border-radius: 4px;\r\n  padding: 10px;\r\n  margin: 0 0 10px;\r\n}\r\n.count {\r\n  padding: 5px;\r\n  line-height: 1.75;\r\n  font-size: 1.25rem;\r\n  font-weight: bold;\r\n}\r\n.comment-meta {\r\n  margin-left: 0.8rem;\r\n  width: 100%;\r\n  border-bottom: 1px dashed #f5f5f5;\r\n}\r\n.reply-meta {\r\n  margin-left: 0.8rem;\r\n  width: 100%;\r\n}\r\n.comment-user {\r\n  font-size: 14px;\r\n  line-height: 1.75;\r\n}\r\n.comment-user a {\r\n  color: #1abc9c !important;\r\n  font-weight: 500;\r\n  transition: 0.3s all;\r\n}\r\n.comment-nickname {\r\n  text-decoration: none;\r\n  color: #1abc9c !important;\r\n  font-weight: 500;\r\n}\r\n.comment-info {\r\n  line-height: 1.75;\r\n  font-size: 0.75rem;\r\n  color: #b3b3b3;\r\n}\r\n.reply-btn {\r\n  cursor: pointer;\r\n  float: right;\r\n  color: #ef2f11;\r\n}\r\n.comment-content {\r\n  font-size: 0.875rem;\r\n  line-height: 1.75;\r\n  padding-top: 0.625rem;\r\n}\r\n.comment-avatar {\r\n  transition: all 0.5s;\r\n}\r\n.comment-avatar:hover {\r\n  transform: rotate(360deg);\r\n}\r\n.like {\r\n  cursor: pointer;\r\n  font-size: 0.875rem;\r\n}\r\n.like:hover {\r\n  color: #eb5055;\r\n}\r\n.like-active {\r\n  cursor: pointer;\r\n  font-size: 0.875rem;\r\n  color: #eb5055;\r\n}\r\n.load-wrapper {\r\n  margin-top: 10px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n.load-wrapper button {\r\n  background-color: #49b1f5;\r\n  color: #fff;\r\n}\r\n</style>\r\n"],"mappings":";AAwMA,OAAAA,KAAA;AACA,OAAAC,MAAA;AACA,OAAAC,KAAA;AACA,OAAAC,SAAA;AACA,SAAAC,UAAA,EAAAC,aAAA,EAAAC,cAAA;AACA;EACAC,UAAA;IACAP,KAAA;IACAE,KAAA;IACAD;EACA;EACAO,KAAA;IACAC,WAAA;MACAC,IAAA,EAAAC;IACA;IACAC,KAAA;MACAF,IAAA,EAAAG;IACA;EACA;EACAC,IAAA,WAAAA,CAAA;IACA;MACAC,OAAA;MACAC,GAAA,EAAAC,OAAA,CAAAC,GAAA,CAAAC,eAAA;MACAC,cAAA;MACAC,WAAA;MACAC,OAAA;IACA;EACA;EACAC,OAAA;IACAC,aAAAC,KAAA,EAAAC,IAAA;MACA,KAAAC,KAAA,CAAAC,KAAA,CAAAC,OAAA,CAAAH,IAAA;QACAA,IAAA,CAAAI,GAAA,CAAAC,KAAA,CAAAC,OAAA;MACA;MACA;MACA,KAAAL,KAAA,CAAAC,KAAA,CAAAH,KAAA,EAAAL,cAAA;MACA,KAAAO,KAAA,CAAAC,KAAA,CAAAH,KAAA,EAAAQ,QAAA,GAAAP,IAAA,CAAAO,QAAA;MACA,KAAAN,KAAA,CAAAC,KAAA,CAAAH,KAAA,EAAAS,WAAA,GAAAR,IAAA,CAAAS,MAAA;MACA,KAAAR,KAAA,CAAAC,KAAA,CAAAH,KAAA,EAAAW,QAAA,QAAA3B,WAAA,CAAAgB,KAAA,EAAAY,EAAA;MACA,KAAAV,KAAA,CAAAC,KAAA,CAAAH,KAAA,EAAAJ,WAAA;MACA,KAAAM,KAAA,CAAAC,KAAA,CAAAH,KAAA,EAAAA,KAAA,GAAAA,KAAA;MACA,KAAAE,KAAA,CAAAC,KAAA,CAAAH,KAAA,EAAAK,GAAA,CAAAC,KAAA,CAAAC,OAAA;IACA;IACAM,SAAAC,GAAA;MACA,KAAAnB,cAAA,IAAAmB,GAAA;IACA;IACAC,aAAAf,KAAA,EAAAC,IAAA;MACApB,cAAA;QAAAmC,SAAA,EAAAf,IAAA,CAAAW,EAAA;QAAAK,MAAA;QAAAC,QAAA;MAAA,GAAAC,IAAA,CAAAC,GAAA;QACA,KAAAlB,KAAA,CAAAmB,KAAA,CAAArB,KAAA,EAAAM,KAAA,CAAAC,OAAA;QACAN,IAAA,CAAAqB,YAAA,GAAAF,GAAA,CAAA/B,IAAA;QACA;QACA,IAAAkC,IAAA,CAAAC,IAAA,CAAAvB,IAAA,CAAAwB,UAAA;UACA,KAAAvB,KAAA,CAAAwB,MAAA,CAAA1B,KAAA,EAAAM,KAAA,CAAAC,OAAA;QACA;MACA;IACA;IACAoB,mBAAA9B,OAAA,EAAAG,KAAA,EAAAgB,SAAA;MACA;MACAnC,cAAA;QAAAmC,SAAA,EAAAA,SAAA;QAAAC,MAAA,EAAApB,OAAA;QAAAqB,QAAA;MAAA,GAAAC,IAAA,CAAAC,GAAA;QACA,KAAApC,WAAA,CAAAgB,KAAA,EAAAsB,YAAA,GAAAF,GAAA,CAAA/B,IAAA;MACA;IACA;IACAuC,aAAA;MACA;MACA,KAAA/B,OAAA;MACA,MAAAgC,IAAA,QAAAC,MAAA,CAAAD,IAAA;MACA,MAAAE,GAAA,GAAAF,IAAA,CAAAG,KAAA;MACApD,aAAA;QAAAqC,MAAA,OAAApB,OAAA;QAAAqB,QAAA;QAAAe,SAAA,EAAAF,GAAA;MAAA,GAAAZ,IAAA,CAAAC,GAAA;QACAA,GAAA,CAAA/B,IAAA,CAAA6C,cAAA,CAAA9B,OAAA,CAAAH,IAAA;UACA,KAAAjB,WAAA,CAAAmD,IAAA,CAAAlC,IAAA;QACA;MACA;IACA;IACAmC,cAAA;MACA;MACA,IAAA1B,MAAA,QAAA2B,MAAA,CAAAC,KAAA,CAAA5B,MAAA;MACA,KAAAA,MAAA;QACA,KAAA2B,MAAA,CAAAC,KAAA,CAAAC,SAAA;QACA;MACA;MACA;MACA,SAAA5C,cAAA,CAAA6C,IAAA;QACA,KAAAC,MAAA;UAAAxD,IAAA;UAAAyD,OAAA;QAAA;QACA;MACA;MACA;MACA,IAAAC,GAAA;MACA,KAAAhD,cAAA,QAAAA,cAAA,CAAAiD,OAAA,CAAAD,GAAA,YAAAE,GAAA;QACA,OACA,gBACAnE,SAAA,CAAAmE,GAAA,IACA;MAEA;MACA;MACA,MAAAhB,IAAA,QAAAC,MAAA,CAAAD,IAAA;MACA,MAAAE,GAAA,GAAAF,IAAA,CAAAG,KAAA;MACA,IAAAc,OAAA;QACAb,SAAA,EAAAF,GAAA;QACApC,cAAA,OAAAA;MACA;MACA,KAAAA,cAAA;MACAhB,UAAA,CAAAmE,OAAA,EAAA3B,IAAA,CAAAC,GAAA;QACA;QACA,KAAA2B,KAAA;QACA,KAAAN,MAAA;UAAAxD,IAAA;UAAAyD,OAAA;QAAA;QACA;AACA;AACA;AACA;AACA;AACA;AACA;MACA,GAAAM,KAAA,CAAAC,GAAA;QACAC,OAAA,CAAAC,KAAA,CAAAF,GAAA;MACA;IACA;IACAG,YAAApD,KAAA;MACAnB,cAAA;QACAmC,SAAA,OAAAhC,WAAA,CAAAgB,KAAA,EAAAY,EAAA;QACAM,QAAA;QACAD,MAAA,OAAAf,KAAA,CAAAmD,IAAA,CAAArD,KAAA,EAAAH;MACA,GAAAsB,IAAA,CAAAC,GAAA;QACA,KAAApC,WAAA,CAAAgB,KAAA,EAAAyB,UAAA;QACA;QACA,SAAAzC,WAAA,CAAAgB,KAAA,EAAAyB,UAAA;UACA,KAAAvB,KAAA,CAAAwB,MAAA,CAAA1B,KAAA,EAAAM,KAAA,CAAAC,OAAA;QACA;QACA,KAAAL,KAAA,CAAAmB,KAAA,CAAArB,KAAA,EAAAM,KAAA,CAAAC,OAAA;QACA,KAAAL,KAAA,CAAAC,KAAA,CAAAH,KAAA,EAAAK,GAAA,CAAAC,KAAA,CAAAC,OAAA;QACA,KAAAvB,WAAA,CAAAgB,KAAA,EAAAsB,YAAA,GAAAF,GAAA,CAAA/B,IAAA;MACA;IACA;EACA;EACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACAiE,KAAA;IACAtE,YAAA;MACA,KAAAM,OAAA;MACA,KAAAiE,SAAA;QACA,KAAAjE,OAAA;MACA;IACA;EACA;AACA","ignoreList":[]}]}