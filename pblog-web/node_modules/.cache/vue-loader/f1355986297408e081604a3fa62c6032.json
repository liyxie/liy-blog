{"remainingRequest":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\src\\components\\model\\ForgetModel.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\src\\components\\model\\ForgetModel.vue","mtime":1721286706044},{"path":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\node_modules\\.store\\babel-loader@8.3.0\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\MyWenJian\\Blogs\\rulin-blog\\pblog-web\\node_modules\\.store\\vue-loader@15.11.1\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBzZW5kRW1haWxDb2RlLCBlbWFpbFJlZ2lzdGVyLCBlbWFpbExvZ2luLCB1cGRhdGVQYXNzd29yZCB9IGZyb20gIi4uLy4uL2FwaSI7DQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGE6IGZ1bmN0aW9uKCkgew0KICAgIHJldHVybiB7DQogICAgICB1c2VybmFtZTogIiIsDQogICAgICBjb2RlOiAiIiwNCiAgICAgIHBhc3N3b3JkOiAiIiwNCiAgICAgIGZsYWc6IHRydWUsDQogICAgICBjb2RlTXNnOiAi5Y+R6YCBIiwNCiAgICAgIHRpbWU6IDYwLA0KICAgICAgc2hvdzogZmFsc2UNCiAgICB9Ow0KICB9LA0KICBtZXRob2RzOiB7DQogICAgb3BlbkxvZ2luKCkgew0KICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuZm9yZ2V0RmxhZyA9IGZhbHNlOw0KICAgICAgdGhpcy4kc3RvcmUuc3RhdGUubG9naW5GbGFnID0gdHJ1ZTsNCiAgICB9LA0KICAgIHNlbmRDb2RlKCkgew0KICAgICAgLy/lj5HpgIHpgq7ku7YNCiAgICAgIHRoaXMuY291bnREb3duKCk7DQogICAgICBzZW5kRW1haWxDb2RlKHRoaXMudXNlcm5hbWUpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy4kdG9hc3QoeyB0eXBlOiAic3VjY2VzcyIsIG1lc3NhZ2U6cmVzLm1lc3NhZ2UgfSk7DQogICAgICB9KS5jYXRjaChlcnIgPT57DQogICAgICAgIHRoaXMuJHRvYXN0KHsgdHlwZTogImVycm9yIiwgbWVzc2FnZTogZXJyLm1lc3NhZ2UgfSk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIGNvdW50RG93bigpIHsNCiAgICAgIHRoaXMuZmxhZyA9IHRydWU7DQogICAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gew0KICAgICAgICB0aGlzLnRpbWUtLTsNCiAgICAgICAgdGhpcy5jb2RlTXNnID0gdGhpcy50aW1lICsgInMiOw0KICAgICAgICBpZiAodGhpcy50aW1lIDw9IDApIHsNCiAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpOw0KICAgICAgICAgIHRoaXMuY29kZU1zZyA9ICLlj5HpgIEiOw0KICAgICAgICAgIHRoaXMudGltZSA9IDYwOw0KICAgICAgICAgIHRoaXMuZmxhZyA9IGZhbHNlOw0KICAgICAgICB9DQogICAgICB9LCAxMDAwKTsNCiAgICB9LA0KICAgIGZvcmdldCgpIHsNCiAgICAgIHZhciByZWcgPSAvXltBLVphLXowLTlcdTRlMDAtXHU5ZmE1X10rQFthLXpBLVowLTlfLV0rKFwuW2EtekEtWjAtOV8tXSspKyQvOw0KICAgICAgaWYgKCFyZWcudGVzdCh0aGlzLnVzZXJuYW1lKSkgew0KICAgICAgICB0aGlzLiR0b2FzdCh7IHR5cGU6ICJlcnJvciIsIG1lc3NhZ2U6ICLpgq7nrrHmoLzlvI/kuI3mraPnoa4iIH0pOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICB9DQogICAgICBpZiAodGhpcy5jb2RlLnRyaW0oKS5sZW5ndGggIT09IDYpIHsNCiAgICAgICAgdGhpcy4kdG9hc3QoeyB0eXBlOiAiZXJyb3IiLCBtZXNzYWdlOiAi6K+36L6T5YWlNuS9jemqjOivgeeggSIgfSk7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0NCiAgICAgIGlmICh0aGlzLnBhc3N3b3JkLnRyaW0oKS5sZW5ndGggPCA2KSB7DQogICAgICAgIHRoaXMuJHRvYXN0KHsgdHlwZTogImVycm9yIiwgbWVzc2FnZTogIuWvhueggeS4jeiDveWwkeS6jjbkvY0iIH0pOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICB9DQogICAgICBjb25zdCB1c2VyID0gew0KICAgICAgICBlbWFpbDogdGhpcy51c2VybmFtZSwNCiAgICAgICAgcGFzc3dvcmQ6IHRoaXMucGFzc3dvcmQsDQogICAgICAgIGNvZGU6IHRoaXMuY29kZQ0KICAgICAgfTsNCiAgICAgIHVwZGF0ZVBhc3N3b3JkKHVzZXIpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy4kdG9hc3QoeyB0eXBlOiAic3VjY2VzcyIsIG1lc3NhZ2U6IHJlcy5tZXNzYWdlIH0pOw0KICAgICAgfSkuY2F0Y2goZXJyID0+ew0KICAgICAgICB0aGlzLiR0b2FzdCh7IHR5cGU6ICJlcnJvciIsIG1lc3NhZ2U6IGVyci5tZXNzYWdlIH0pOw0KICAgICAgfSk7DQogICAgfQ0KICB9LA0KICBjb21wdXRlZDogew0KICAgIGZvcmdldEZsYWc6IHsNCiAgICAgIHNldCh2YWx1ZSkgew0KICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5mb3JnZXRGbGFnID0gdmFsdWU7DQogICAgICB9LA0KICAgICAgZ2V0KCkgew0KICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuZm9yZ2V0RmxhZzsNCiAgICAgIH0NCiAgICB9LA0KICAgIGlzTW9iaWxlKCkgew0KICAgICAgY29uc3QgY2xpZW50V2lkdGggPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGg7DQogICAgICBpZiAoY2xpZW50V2lkdGggPiA5NjApIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICB9LA0KICB3YXRjaDogew0KICAgIHVzZXJuYW1lKHZhbHVlKSB7DQogICAgICB2YXIgcmVnID0gL15bQS1aYS16MC05XHU0ZTAwLVx1OWZhNV0rQFthLXpBLVowLTlfLV0rKFwuW2EtekEtWjAtOV8tXSspKyQvOw0KICAgICAgaWYgKHJlZy50ZXN0KHZhbHVlKSkgew0KICAgICAgICB0aGlzLmZsYWcgPSBmYWxzZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuZmxhZyA9IHRydWU7DQogICAgICB9DQogICAgfQ0KICB9DQp9Ow0K"},{"version":3,"sources":["ForgetModel.vue"],"names":[],"mappings":";AA2DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ForgetModel.vue","sourceRoot":"src/components/model","sourcesContent":["<template>\r\n  <v-dialog v-model=\"forgetFlag\" max-width=\"460\">\r\n    <v-card class=\"login-container\" style=\"border-radius:4px;height: 55vh\">\r\n      <v-icon class=\"float-right\" @click=\"forgetFlag = false\">\r\n        mdi-close\r\n      </v-icon>\r\n      <div class=\"login-wrapper\" style=\"padding: 2vh 0.5em 0 0.5rem;\">\r\n        <!-- 用户名 -->\r\n        <v-text-field\r\n          v-model=\"username\"\r\n          label=\"邮箱号\"\r\n          placeholder=\"请输入您的邮箱号\"\r\n          clearable\r\n          @keyup.enter=\"forget\"\r\n        />\r\n        <!-- 验证码 -->\r\n        <div class=\"mt-7 send-wrapper\">\r\n          <v-text-field\r\n            maxlength=\"6\"\r\n            v-model=\"code\"\r\n            label=\"验证码\"\r\n            placeholder=\"请输入6位验证码\"\r\n            @keyup.enter=\"forget\"\r\n          />\r\n          <v-btn :disabled=\"flag\" text small @click=\"sendCode\">\r\n            {{ codeMsg }}\r\n          </v-btn>\r\n        </div>\r\n        <!-- 密码 -->\r\n        <v-text-field\r\n          v-model=\"password\"\r\n          class=\"mt-7\"\r\n          label=\"密码\"\r\n          placeholder=\"请输入您的密码\"\r\n          @keyup.enter=\"forget\"\r\n          :append-icon=\"show ? 'mdi-eye' : 'mdi-eye-off'\"\r\n          :type=\"show ? 'text' : 'password'\"\r\n          @click:append=\"show = !show\"\r\n        />\r\n        <!-- 按钮 -->\r\n        <v-btn\r\n          class=\"mt-7\"\r\n          block\r\n          color=\"green\"\r\n          style=\"color:#fff\"\r\n          @click=\"forget\"\r\n        >\r\n          确定\r\n        </v-btn>\r\n        <!-- 登录 -->\r\n        <div class=\"mt-10 login-tip\">\r\n          已有账号？<span @click=\"openLogin\">登录</span>\r\n        </div>\r\n      </div>\r\n    </v-card>\r\n  </v-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { sendEmailCode, emailRegister, emailLogin, updatePassword } from \"../../api\";\r\nexport default {\r\n  data: function() {\r\n    return {\r\n      username: \"\",\r\n      code: \"\",\r\n      password: \"\",\r\n      flag: true,\r\n      codeMsg: \"发送\",\r\n      time: 60,\r\n      show: false\r\n    };\r\n  },\r\n  methods: {\r\n    openLogin() {\r\n      this.$store.state.forgetFlag = false;\r\n      this.$store.state.loginFlag = true;\r\n    },\r\n    sendCode() {\r\n      //发送邮件\r\n      this.countDown();\r\n      sendEmailCode(this.username).then(res => {\r\n        this.$toast({ type: \"success\", message:res.message });\r\n      }).catch(err =>{\r\n        this.$toast({ type: \"error\", message: err.message });\r\n      });\r\n    },\r\n    countDown() {\r\n      this.flag = true;\r\n      this.timer = setInterval(() => {\r\n        this.time--;\r\n        this.codeMsg = this.time + \"s\";\r\n        if (this.time <= 0) {\r\n          clearInterval(this.timer);\r\n          this.codeMsg = \"发送\";\r\n          this.time = 60;\r\n          this.flag = false;\r\n        }\r\n      }, 1000);\r\n    },\r\n    forget() {\r\n      var reg = /^[A-Za-z0-9\\u4e00-\\u9fa5_]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$/;\r\n      if (!reg.test(this.username)) {\r\n        this.$toast({ type: \"error\", message: \"邮箱格式不正确\" });\r\n        return false;\r\n      }\r\n      if (this.code.trim().length !== 6) {\r\n        this.$toast({ type: \"error\", message: \"请输入6位验证码\" });\r\n        return false;\r\n      }\r\n      if (this.password.trim().length < 6) {\r\n        this.$toast({ type: \"error\", message: \"密码不能少于6位\" });\r\n        return false;\r\n      }\r\n      const user = {\r\n        email: this.username,\r\n        password: this.password,\r\n        code: this.code\r\n      };\r\n      updatePassword(user).then(res => {\r\n        this.$toast({ type: \"success\", message: res.message });\r\n      }).catch(err =>{\r\n        this.$toast({ type: \"error\", message: err.message });\r\n      });\r\n    }\r\n  },\r\n  computed: {\r\n    forgetFlag: {\r\n      set(value) {\r\n        this.$store.state.forgetFlag = value;\r\n      },\r\n      get() {\r\n        return this.$store.state.forgetFlag;\r\n      }\r\n    },\r\n    isMobile() {\r\n      const clientWidth = document.documentElement.clientWidth;\r\n      if (clientWidth > 960) {\r\n        return false;\r\n      }\r\n      return true;\r\n    }\r\n  },\r\n  watch: {\r\n    username(value) {\r\n      var reg = /^[A-Za-z0-9\\u4e00-\\u9fa5]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$/;\r\n      if (reg.test(value)) {\r\n        this.flag = false;\r\n      } else {\r\n        this.flag = true;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n"]}]}